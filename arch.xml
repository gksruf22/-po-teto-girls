<mxfile host="app.diagrams.net" modified="2025-10-25" agent="ChatGPT" version="24.7.7" editor="diagramly" type="device">
  <diagram id="t_talk" name="T-Talk Architecture">
    <mxGraphModel dx="1560" dy="940" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1080" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="T-Talk 시스템 아키텍처" style="text;html=1;align=center;verticalAlign=top;fontSize=24;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="720" y="20" width="480" height="40" as="geometry"/>
        </mxCell>

        <!-- Client -->
        <mxCell id="client" value="웹 브라우저 (Client)\nhttp://localhost:5173" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="120" y="120" width="280" height="90" as="geometry"/>
        </mxCell>

        <!-- Frontend Container -->
        <mxCell id="frontend" value="React Frontend (Vite)" style="swimlane;rounded=1;html=1;childLayout=stackLayout;horizontal=1;startSize=28;fillColor=#e1f5fe;strokeColor=#0288D1;" vertex="1" parent="1">
          <mxGeometry x="440" y="100" width="420" height="300" as="geometry"/>
        </mxCell>

        <!-- Frontend children -->
        <mxCell id="home" value="Home.tsx" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#0288D1;" vertex="1" parent="frontend">
          <mxGeometry x="20" y="40" width="170" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="login" value="Login.tsx" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#0288D1;" vertex="1" parent="frontend">
          <mxGeometry x="210" y="40" width="170" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="chat" value="Chat.tsx" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#0288D1;" vertex="1" parent="frontend">
          <mxGeometry x="20" y="110" width="170" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="authctx" value="AuthContext.tsx\n(세션 관리)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#0288D1;" vertex="1" parent="frontend">
          <mxGeometry x="210" y="110" width="170" height="60" as="geometry"/>
        </mxCell>

        <!-- HTTP label -->
        <mxCell id="httpLabel" value="HTTP/HTTPS (Session Cookie)" style="text;html=1;align=left;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="320" y="160" width="180" height="20" as="geometry"/>
        </mxCell>

        <!-- Edge Client -> Frontend -->
        <mxCell id="edge_client_front" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="client" target="frontend">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Backend Container -->
        <mxCell id="backend" value="Spring Boot Backend (Port 8080)" style="swimlane;rounded=1;html=1;startSize=32;fillColor=#f3e5f5;strokeColor=#7B1FA2;" vertex="1" parent="1">
          <mxGeometry x="940" y="80" width="620" height="540" as="geometry"/>
        </mxCell>

        <!-- Security Layer group -->
        <mxCell id="security_group" value="Security Layer" style="swimlane;rounded=1;html=1;startSize=24;fillColor=#ede7f6;strokeColor=#673AB7;" vertex="1" parent="backend">
          <mxGeometry x="20" y="40" width="280" height="160" as="geometry"/>
        </mxCell>
        <mxCell id="security_config" value="SecurityConfig\n(Session Auth)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#673AB7;" vertex="1" parent="security_group">
          <mxGeometry x="10" y="40" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="web_config" value="WebConfig\n(CORS)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#673AB7;" vertex="1" parent="security_group">
          <mxGeometry x="150" y="40" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="httpsession" value="HttpSession\nManagement" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#673AB7;" vertex="1" parent="security_group">
          <mxGeometry x="80" y="100" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Controller Layer group -->
        <mxCell id="controller_group" value="Controller Layer" style="swimlane;rounded=1;html=1;startSize=24;fillColor=#fff3e0;strokeColor=#FB8C00;" vertex="1" parent="backend">
          <mxGeometry x="320" y="40" width="280" height="160" as="geometry"/>
        </mxCell>
        <mxCell id="auth_controller" value="AuthController\n/api/auth/*" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#FB8C00;" vertex="1" parent="controller_group">
          <mxGeometry x="10" y="40" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="chat_controller" value="ChatController\n/api/chat" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#FB8C00;" vertex="1" parent="controller_group">
          <mxGeometry x="150" y="40" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Service Layer group -->
        <mxCell id="service_group" value="Service Layer" style="swimlane;rounded=1;html=1;startSize=24;fillColor=#e8f5e9;strokeColor=#43A047;" vertex="1" parent="backend">
          <mxGeometry x="20" y="220" width="280" height="160" as="geometry"/>
        </mxCell>
        <mxCell id="auth_service" value="AuthService\n(User 인증/등록)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43A047;" vertex="1" parent="service_group">
          <mxGeometry x="10" y="40" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="chat_service" value="ChatService\n(Gemini 통신)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#43A047;" vertex="1" parent="service_group">
          <mxGeometry x="150" y="40" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Repository Layer group -->
        <mxCell id="repo_group" value="Repository Layer" style="swimlane;rounded=1;html=1;startSize=24;fillColor=#f1f8e9;strokeColor=#7CB342;" vertex="1" parent="backend">
          <mxGeometry x="320" y="220" width="280" height="160" as="geometry"/>
        </mxCell>
        <mxCell id="user_repo" value="UserRepository\n(JPA)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#7CB342;" vertex="1" parent="repo_group">
          <mxGeometry x="10" y="40" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="chat_repo" value="ChatHistoryRepository" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#7CB342;" vertex="1" parent="repo_group">
          <mxGeometry x="150" y="40" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- AI Layer group -->
        <mxCell id="ai_group" value="AI Layer" style="swimlane;rounded=1;html=1;startSize=24;fillColor=#e0f2f1;strokeColor=#00897B;" vertex="1" parent="backend">
          <mxGeometry x="20" y="400" width="280" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="gemini" value="Gemini 2.5 Flash\nAPI Client" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#00897B;" vertex="1" parent="ai_group">
          <mxGeometry x="70" y="40" width="140" height="50" as="geometry"/>
        </mxCell>

        <!-- H2 Database container -->
        <mxCell id="db_container" value="H2 Database (file:./data/tchatbot)" style="swimlane;rounded=1;html=1;startSize=28;fillColor=#fffde7;strokeColor=#FBC02D;" vertex="1" parent="1">
          <mxGeometry x="460" y="460" width="420" height="260" as="geometry"/>
        </mxCell>
        <mxCell id="users_table" value="users\n- id\n- email\n- password\n- username\n- created_at" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#FBC02D;" vertex="1" parent="db_container">
          <mxGeometry x="20" y="50" width="170" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="ch_table" value="chat_history\n- id\n- user_id (FK)\n- user_message\n- bot_response\n- is_public\n- created_at" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#FBC02D;" vertex="1" parent="db_container">
          <mxGeometry x="210" y="50" width="180" height="140" as="geometry"/>
        </mxCell>

        <!-- Edges inside backend -->
        <mxCell id="edge_sec_ctrl" style="endArrow=block;html=1;dashed=1;strokeWidth=2;strokeColor=#7B1FA2;" edge="1" parent="backend" source="security_group" target="controller_group">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_ctrl_service1" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="backend" source="auth_controller" target="auth_service">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_ctrl_service2" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="backend" source="chat_controller" target="chat_service">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_service_repo1" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="backend" source="auth_service" target="user_repo">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_service_repo2" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="backend" source="chat_service" target="chat_repo">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="edge_chatservice_ai" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="backend" source="chat_service" target="gemini">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Frontend to Backend (Axios) -->
        <mxCell id="axios_label" value="Axios (withCredentials: true)" style="text;html=1;align=left;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="880" y="260" width="210" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="edge_front_backend" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="frontend" target="backend">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Backend to DB -->
        <mxCell id="edge_backend_db" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="backend" target="db_container">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Extra notes -->
        <mxCell id="notes" value="인증: Session 기반 (JSESSIONID, HttpOnly, CORS allowCredentials)\nAPI:\n- POST /api/auth/signup, /login (공개)\n- POST /api/auth/logout, GET /api/auth/check (세션 필요)\n- POST /api/chat (세션 필요)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#9E9E9E;" vertex="1" parent="1">
          <mxGeometry x="1100" y="640" width="460" height="140" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
